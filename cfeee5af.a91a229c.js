(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{104:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var r=n(0),a=n.n(r);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=a.a.createContext({}),l=function(e){var t=a.a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=l(e.components);return a.a.createElement(p.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},b=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),u=l(n),b=r,d=u["".concat(s,".").concat(b)]||u[b]||m[b]||o;return n?a.a.createElement(d,i(i({ref:t},p),{},{components:n})):a.a.createElement(d,i({ref:t},p))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,s=new Array(o);s[0]=b;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:r,s[1]=i;for(var p=2;p<o;p++)s[p]=n[p];return a.a.createElement.apply(null,s)}return a.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"},117:function(e,t,n){"use strict";var r=n(0),a={name:"urx-example",version:"1.0.0",description:"urx example",keywords:["typescript","react","starter"],main:"src/index.tsx",dependencies:{"@virtuoso.dev/urx":"latest","@virtuoso.dev/react-urx":"latest",react:"^16.12.0","react-dom":"^16.12.0","react-scripts":"3.3.0"},devDependencies:{"@types/react":"16.9.19","@types/react-dom":"16.9.5",typescript:"3.7.5"},scripts:{start:"react-scripts start",build:"react-scripts build",test:"react-scripts test --env=jsdom",eject:"react-scripts eject"},browserslist:[">0.2%","not dead","not ie <= 11","not op_mini all"]};function o(e){var t=e.target.parentElement.nextElementSibling.querySelector(".prism-code").innerText;fetch("https://codesandbox.io/api/v1/sandboxes/define?json=1",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({files:{"package.json":{content:a},"src/example.tsx":{content:t},"src/index.tsx":{content:'\nimport * as React from "react";\nimport { render } from "react-dom";\n\nimport App from "./example";\n\nconst rootElement = document.getElementById("root");\nrender(<App />, rootElement);\n'},"public/index.html":{content:'<div id="root"></div>'}}})}).then((function(e){return e.json()})).then((function(e){window.open("https://codesandbox.io/s/"+e.sandbox_id+"?file=/src/example.tsx","_blank")}))}t.a=function(){return r.createElement("div",{style:{position:"relative",zIndex:2}},r.createElement("button",{className:"open-in-sandbox",onClick:o},"Open in Sandbox"))}},93:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return c})),n.d(t,"rightToc",(function(){return p})),n.d(t,"default",(function(){return u}));var r=n(2),a=n(6),o=(n(0),n(104)),s=n(117),i={id:"urx-in-react",title:"urx in React",sidebar_label:"urx in React"},c={unversionedId:"urx-in-react",id:"urx-in-react",isDocsHomePage:!1,title:"urx in React",description:"The @virtuoso.dev/react-urx systemToComponent wraps urx systems in UI logic provider components by mapping the system input and output streams to the component input / output points.",source:"@site/docs/urx-in-react.md",permalink:"/docs/urx-in-react",editUrl:"https://github.com/virtuoso-dev/urx/edit/master/packages/docs/docs/docs/urx-in-react.md",sidebar_label:"urx in React",sidebar:"typedoc",previous:{title:"Thinking in Systems",permalink:"/docs/thinking-in-systems"},next:{title:"urx/src/actions",permalink:"/docs/modules/_urx_src_actions_"}},p=[{value:"Component Props to Streams",id:"component-props-to-streams",children:[]},{value:"Hooks to Streams",id:"hooks-to-streams",children:[{value:"Summary",id:"summary",children:[]}]}],l={rightToc:p};function u(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(o.b)("wrapper",Object(r.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",{className:"lead"},"The `@virtuoso.dev/react-urx` `systemToComponent` wraps urx systems in UI **logic provider components** by mapping the system input and output streams to the component input / output points."),Object(o.b)(s.a,{mdxType:"OpenInSandbox"}),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-tsx"}),'import * as React from "react";\nimport { systemToComponent } from "@virtuoso.dev/react-urx";\nimport { system, statefulStream, } from "@virtuoso.dev/urx";\n\nconst sys = system(() => {\n  const foo = statefulStream(42)\n  return { foo }\n})\n\nconst { Component: MyComponent, useEmitterValue } = systemToComponent(sys, {\n  required: { fooProp: \'foo\' },\n})\n\nconst Child = () => {\n  const foo = useEmitterValue(\'foo\')\n  return <div>{foo}</div>\n}\n\nexport default function App() {\n  return <MyComponent fooProp={42}><Child /></MyComponent>\n}\n')),Object(o.b)("h2",{id:"component-props-to-streams"},"Component Props to Streams"),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"systemToComponent")," accepts a ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"./interfaces/_urx_src_system_.systemspec"}),"SystemSpec")," and a map object, which lists the component:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"required properties"),Object(o.b)("li",{parentName:"ul"},"optional properties"),Object(o.b)("li",{parentName:"ul"},"event properties"),Object(o.b)("li",{parentName:"ul"},"methods")),Object(o.b)("p",null,"The function does not do a formal check if the specified streams are suitable for the type of property.\nCheck the table below for what kind of stream works for what kind of property."),Object(o.b)("table",null,Object(o.b)("thead",{parentName:"table"},Object(o.b)("tr",{parentName:"thead"},Object(o.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Component Traits"),Object(o.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Mapped Stream Type"),Object(o.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Notes"))),Object(o.b)("tbody",{parentName:"table"},Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Value properties"),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Stateful input streams (Publishers)"),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Value properties can be thought of as system parameters, which can change over time. In practice, such parameters must have some sort of initial value, even if it is undefined.")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Event properties"),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Stateless output streams (Emitters)"),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Component events are special properties which accept callbacks. The mapping applies those callbacks as subscriptions to the specified stream. It is counter intuitive to fire event handlers upon component initialization, so you should use stateless streams for events.")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Methods"),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Stateless input streams (Publishers)"),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Component methods (limited to a single argument) publish the passed argument into the specified stream.")))),Object(o.b)("h2",{id:"hooks-to-streams"},"Hooks to Streams"),Object(o.b)("p",null,"The resulting React component does not render UI. Instead, it exposes hooks which allow its child components to interact with the underlying system.\nIn React, this happens through the following hooks:"),Object(o.b)("table",null,Object(o.b)("thead",{parentName:"table"},Object(o.b)("tr",{parentName:"thead"},Object(o.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Hook"),Object(o.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Stream Type"),Object(o.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Notes"))),Object(o.b)("tbody",{parentName:"table"},Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(o.b)("inlineCode",{parentName:"td"},"useEmitterValue")),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Stateful output streams"),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"The hook uses ",Object(o.b)("inlineCode",{parentName:"td"},"useState")," internally and re-renders the component when the stream emits a value. Works only with stateful streams.")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(o.b)("inlineCode",{parentName:"td"},"useEmitter")),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Output streams"),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Calls the specified callback when the stream emits a value. Does not re-render the component, works with both stateful and stateless streams.")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(o.b)("inlineCode",{parentName:"td"},"usePublisher")),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Input streams"),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Returns a function which can publish the passed argument into the stream. Works with both stateful and stateless streams.")))),Object(o.b)("h4",{id:"hooks-example"},"Hooks Example"),Object(o.b)("p",null,'The example below shows the three types of hooks wired up to a simple system. Press the "open in sandbox button" to fiddle with it further.'),Object(o.b)(s.a,{mdxType:"OpenInSandbox"}),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-tsx"}),'import * as React from "react";\nimport { systemToComponent } from "@virtuoso.dev/react-urx";\n\nimport {\n  system,\n  statefulStream,\n  map,\n  pipe,\n  statefulStreamFromEmitter,\n} from "@virtuoso.dev/urx";\n\nconst sys = system(() => {\n  const foo = statefulStream(2);\n\n  const bar = statefulStreamFromEmitter(\n    pipe(\n      foo,\n      map((value) => value * 2)\n    ),\n    4\n  );\n\n  return {\n    // input\n    foo,\n    // output\n    bar,\n  };\n});\n\nconst {\n  Component,\n  useEmitter,\n  usePublisher,\n  useEmitterValue,\n} = systemToComponent(sys, {\n  optional: { foo: "foo" },\n});\n\nconst Child1 = () => {\n  const fooValue = useEmitterValue("foo");\n  return <div>{fooValue}</div>;\n};\n\nconst Child2 = () => {\n  useEmitter("bar", (value) => console.info(value));\n  return (\n    <div>\n      <hr /> Open the console to see bar value\n    </div>\n  );\n};\n\nconst Child3 = () => {\n  const changeFooTo = usePublisher("foo");\n  return (\n    <div>\n      <hr />\n      <button onClick={() => changeFooTo(33)}>Change foo to 33</button>\n    </div>\n  );\n};\n\nexport default function App() {\n  return (\n    <Component foo={42}>\n      <Child1 />\n      <Child2 />\n      <Child3 />\n    </Component>\n  );\n}\n')),Object(o.b)("h3",{id:"summary"},"Summary"),Object(o.b)("p",null,"Reducing the various component I/O points to streams and modeling their interactions\neases implementing complex yet resilient UI components and allows testing of the component logic outside\nthe React lifecycle."),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{}),"")))}u.isMDXComponent=!0}}]);